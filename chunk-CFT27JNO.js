import{a as w}from"./chunk-BYI4KDEW.js";import{a as b}from"./chunk-JC3YLUXG.js";import{a as v}from"./chunk-QMLXWTAL.js";import{d as y}from"./chunk-AUTYEGHN.js";import{J as n,K as m,L as p,Q as d,Va as f,W as h,ab as u,gb as _,nb as S,s as l,ub as C,wb as g}from"./chunk-YJCDLP6F.js";var M=(()=>{class r{get rows(){return this._userService.role("admin")?this._petService.pets:this._petService.petsByAuthor[this._userService.user._id]}constructor(o,i,e,s,c,j){this._translate=o,this._petService=i,this._alert=e,this._form=s,this._core=c,this._userService=j,this.columns=["name","species","breed","age","gender","adoptable","description"],this.form=this._form.getForm("pet",w),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(t,a)=>{this._preCreate(t),this._petService.create(t),a()}})},update:t=>{this._form.modal(this.form,[],t).then(a=>{this._core.copy(a,t),this._petService.update(t)})},delete:t=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this pet?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._petService.delete(t)}}]})},buttons:[{icon:"article",hrefFunc:t=>"/records/"+t._id},{icon:"report_problem",hrefFunc:t=>"/allergies/"+t._id},{icon:"cloud_download",click:t=>{this._form.modalUnique("pet","url",t)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]}}_bulkManagement(o=!0){return()=>{this._form.modalDocs(o?[]:this.rows).then(i=>{if(o)for(let e of i)this._preCreate(e),this._petService.create(e);else{for(let e of this.rows)i.find(s=>s._id===e._id)||this._petService.delete(e);for(let e of i){let s=this.rows.find(c=>c._id===e._id);s?(this._core.copy(e,s),this._petService.update(s)):(this._preCreate(e),this._petService.create(e))}}})}}_preCreate(o){delete o.__created}static{this.\u0275fac=function(i){return new(i||r)(n(S),n(b),n(_),n(g),n(u),n(v))}}static{this.\u0275cmp=m({type:r,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Pets",3,"columns","config","rows"]],template:function(i,e){i&1&&h(0,"wtable",0),i&2&&d("columns",e.columns)("config",e.config)("rows",e.rows)},dependencies:[C],encapsulation:2})}}return r})();var F=[{path:"",component:M}],Y=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=p({type:r})}static{this.\u0275inj=l({imports:[f.forChild(F),y]})}}return r})();export{Y as PetsModule};
